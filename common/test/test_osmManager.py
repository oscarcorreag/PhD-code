from unittest import TestCase
from osmmanager import OsmManager
from suitability import SuitableNodeWeightGenerator


class TestOsmManager(TestCase):

    def setUp(self):
        self.osmmgr = OsmManager()
        self.bbox = (144.942043, -37.822496, 145.053342, -37.734496)
        generator = SuitableNodeWeightGenerator()
        self.graph = self.osmmgr.generate_graph_for_bbox(self.bbox[0], self.bbox[1], self.bbox[2], self.bbox[3],
                                                         generator, hotspots=False, pois=False)

    def test_zonify_bbox(self):
        zones = self.osmmgr.zipf_sample_bbox(self.bbox, self.graph.keys(), 100, hotspots=False, pois=False, seed=0)
        self.assertListEqual(zones,
                             [127362667, 251452389, 214131749, 1423021859, 247961910, 1645179845, 310742008, 2172834570,
                              3947168757, 32997295, 34177595, 1272832422, 2905756447, 2207661041, 871096413, 570734694,
                              1283671455, 581831423, 53857533, 387152903, 225183957, 1299225014, 370230599, 1287222143,
                              3218293527, 2180785588, 702450201, 2180785582, 777710193, 775942584, 1833115722,
                              1449431554, 387153044, 598154601, 3313134385, 269335261, 1833121231, 2189497233,
                              2279153652, 778827314, 1449431342, 233314923, 297178812, 1900213537, 233314999, 319862071,
                              3146808113, 266081969, 99498965, 493053630, 227775933, 33239382, 309346901, 333901615,
                              244870022, 250480669, 227316012, 2491032728, 147606698, 559301782, 256715870, 370750302,
                              3810929386, 3126924753, 2481930758, 230397690, 151452152, 283058857, 332797041, 127544544,
                              248746969, 1463620935, 2090721543, 384354011, 2688454941, 1463620394, 301548223,
                              224750279, 246939633, 248969195, 127715644, 361771408, 356083538, 361770537, 248746950,
                              256715871, 313859384, 244859445, 3146808060, 2567155983, 1095506178, 277363029, 356474894,
                              250933657, 224738431, 373008467, 4061053456, 356098372, 233255340, 246998674])

