setwd("C:/Users/oscarcg/Dropbox/Education/Unimelb PhD/code/Experiments/files/Ride-sharing_is_About_Agreeing_on_a_Destination_TSAS_2018/V2/")
synth.csv <- read.csv("master_synth.csv", header = TRUE)
real.csv <- read.csv("master_real.csv", header = TRUE)
# Convert data frame to data table for filtering and grouping.
library(data.table)
synth_dt <- as.data.table(synth.csv)
real_dt <- as.data.table(real.csv)
# Create new columns and adapt others.
synth_dt$Total.users <- synth_dt$Num.queries * synth_dt$Num.users
synth_dt$Total.POIs <- synth_dt$Num.queries * synth_dt$Num.POIs.query
synth_dt$Ratio.total.users.net <- synth_dt$Total.users / synth_dt$Net.size
synth_dt$Ratio.total.POIs.net <- synth_dt$Total.POIs / synth_dt$Net.size
synth_dt$Ratio.users.queries <- synth_dt$Num.users / synth_dt$Num.queries
synth_dt$Ratio.POIs.users <- synth_dt$Total.POIs / synth_dt$Total.users
synth_dt$Alpha <- as.factor(synth_dt$Alpha)
real_dt$Total.users <- real_dt$Num.queries * real_dt$Num.users
real_dt$Num.POIs.query <- 0
real_dt$Ratio.total.users.net <- real_dt$Total.users / real_dt$Net.size
real_dt$Ratio.total.POIs.net <- real_dt$Total.POIs / real_dt$Net.size
real_dt$Ratio.users.queries <- real_dt$Num.users / real_dt$Num.queries
real_dt$Ratio.POIs.users <- real_dt$Total.POIs / real_dt$Total.users
real_dt$Alpha <- as.factor(real_dt$Alpha)
exp_dt <- rbind(synth_dt, real_dt)
# Group by individual samples and aggregate dependent variables.
# Normalise the dependent variables by considering VST-NCA values as basis.
normalize <- function(sd) {
ca <- sd[Algorithm == "VST-CA", -1, with = FALSE]
nca <- sd[Algorithm == "VST-NCA", -1, with = FALSE]
if(nrow(ca) == 1 & nrow(nca) == 1){
a <- ca[1, c("Cost", "WARL", "MWRL", "MRL1", "MRL2", "Entropy", "Elapsed.time")] / nca[1, c("Cost", "WARL", "MWRL", "MRL1", "MRL2", "Entropy", "Elapsed.time")]
b <- ca[1, c("Num.it")]
c(a, b)
}
}
by_cols <- c("Net.size", "Cap", "Merge.cells", "Num.queries", "Num.users.query", "Total.POIs", "POIs.dist", "Alpha", "Beta", "Ratio.total.users.net", "Ratio.total.POIs.net", "Ratio.POIs.users", "Ratio.users.queries", "Sample")
sd_cols <- c("Algorithm", "Cost", "WARL", "MWRL", "MRL1", "MRL2", "Entropy", "Elapsed.time", "Num.it")
pure <- exp_dt[Strategy == "N/A" | Strategy == "pure", normalize(.SD), by = by_cols, .SDcols = sd_cols]
pure$Strategy <- "Pure"
mixed <- exp_dt[Strategy == "N/A" | Strategy == "mixed", normalize(.SD), by = by_cols, .SDcols = sd_cols]
mixed$Strategy <- "Mixed"
# Merge strategies.
exp_dt_2 <- rbind(pure, mixed)
# Merge proportions with actual values.
exp_dt_3 <- merge(exp_dt[Algorithm == "VST-NCA"], exp_dt_2, by = by_cols)
# Columns that show whether VST-CA had effect on congestion in terms of COST.
exp_dt_3$Effect.Cost <- rep("", nrow(exp_dt_3))
exp_dt_3[Cost.y > 1.0, Effect.Cost := "(-)"]
exp_dt_3[Cost.y == 1.0, Effect.Cost := "0%"]
exp_dt_3[Cost.y < 1.0 & Cost.y > 0.95, Effect.Cost := "< 5%"]
exp_dt_3[Cost.y <= 0.95 & Cost.y >= 0.9, Effect.Cost := "5% - 10%"]
exp_dt_3[Cost.y < 0.9, Effect.Cost := "> 10%"]
exp_dt_3$Effect.Cost <- factor(exp_dt_3$Effect.Cost)
exp_dt_3$Effect.Cost <- factor(exp_dt_3$Effect.Cost, levels(exp_dt_3$Effect.Cost)[c(3, 5, 2, 4, 1)])
exp_dt_3$Type.Effect.Cost <- rep("", nrow(exp_dt_3))
exp_dt_3[Cost.y < 1.0, Type.Effect.Cost := "Reduction"]
exp_dt_3[Cost.y == 1.0, Type.Effect.Cost := "No reduction"]
exp_dt_3[Cost.y > 1.0, Type.Effect.Cost := "(-) reduction"]
exp_dt_3$Type.Effect.Cost <- factor(exp_dt_3$Type.Effect.Cost)
exp_dt_3$Type.Effect.Cost <- factor(exp_dt_3$Type.Effect.Cost, levels(exp_dt_3$Type.Effect.Cost)[c(2, 3, 1)])
exp_dt_3$Type.Net <- rep("", nrow(exp_dt_3))
exp_dt_3[POIs.dist %in% c("uniform", "zipfian"), Type.Net := "Synthetic"]
exp_dt_3[POIs.dist %in% c("Manhattan", "Melbourne", "Quito"), Type.Net := "Real"]
exp_dt_3$Type.Net <- factor(exp_dt_3$Type.Net)
synth <- exp_dt_3[Type.Net == "Synthetic"]
synth$POIs.dist <- droplevels(synth$POIs.dist)
#synth$Ratio.POIs.users <- as.factor(synth$Ratio.POIs.users)
synth$Levels.r.users.net <- rep("", nrow(synth))
synth[Ratio.total.users.net <= 0.02, Levels.r.users.net := "[0.00, 0.02]"]
synth[Ratio.total.users.net > 0.02 & Ratio.total.users.net <= 0.04, Levels.r.users.net := "(0.02, 0.04]"]
synth[Ratio.total.users.net > 0.04 & Ratio.total.users.net <= 0.08, Levels.r.users.net := "(0.04, 0.08]"]
synth[Ratio.total.users.net > 0.08 & Ratio.total.users.net <= 0.16, Levels.r.users.net := "(0.08, 0.16]"]
synth[Ratio.total.users.net > 0.16 & Ratio.total.users.net <= 0.32, Levels.r.users.net := "(0.16, 0.32]"]
synth[Ratio.total.users.net > 0.32 & Ratio.total.users.net <= 0.64, Levels.r.users.net := "(0.32, 0.64]"]
synth$Levels.r.users.net <- as.factor(synth$Levels.r.users.net)
synth$Levels.r.users.net <- factor(synth$Levels.r.users.net, levels(synth$Levels.r.users.net)[c(6, 1, 2, 3, 4, 5)])
synth$Levels.r.pois.net <- rep("", nrow(synth))
synth[Ratio.total.POIs.net <= 0.01, Levels.r.pois.net := "[0, 0.01]"]
synth[Ratio.total.POIs.net > 0.01 & Ratio.total.POIs.net <= 0.02,  Levels.r.pois.net := "(0.01, 0.02]"]
synth[Ratio.total.POIs.net > 0.02 & Ratio.total.POIs.net <= 0.03,  Levels.r.pois.net := "(0.02, 0.03]"]
synth[Ratio.total.POIs.net > 0.03 & Ratio.total.POIs.net <= 0.04,  Levels.r.pois.net := "(0.03, 0.04]"]
synth$Levels.r.pois.net <- as.factor(synth$Levels.r.pois.net)
synth$Levels.r.pois.net <- factor(synth$Levels.r.pois.net, levels(synth$Levels.r.pois.net)[c(4, 1, 2, 3)])
synth$Levels.warl.x <- rep("", nrow(synth))
synth[WARL.x <= 0.06, Levels.warl.x := "[0, 0.06]"]
synth[WARL.x > 0.06 & WARL.x <= 0.10, Levels.warl.x := "(0.06, 0.10]"]
synth[WARL.x > 0.10 & WARL.x <= 0.14, Levels.warl.x := "(0.10, 0.14]"]
synth[WARL.x > 0.14 & WARL.x <= 0.18, Levels.warl.x := "(0.14, 0.18]"]
synth[WARL.x > 0.18 & WARL.x <= 0.22, Levels.warl.x := "(0.18, 0.22]"]
synth$Levels.warl.x <- as.factor(synth$Levels.warl.x)
synth$Levels.warl.x <- factor(synth$Levels.warl.x, levels(synth$Levels.warl.x)[c(5, 1, 2, 3, 4)])
real <- exp_dt_3[Type.Net == "Real"]
real$POIs.dist <- droplevels(real$POIs.dist)
real$Levels.r.pois.u <- rep("", nrow(real))
real[Ratio.POIs.users <= 1.0, Levels.r.pois.u := "[0.0, 1.0]"]
real[Ratio.POIs.users > 1.0 & Ratio.POIs.users <= 2.0, Levels.r.pois.u := "(1.0, 2.0]"]
real[Ratio.POIs.users > 2.0 & Ratio.POIs.users <= 3.0, Levels.r.pois.u := "(2.0, 3.0]"]
real[Ratio.POIs.users > 3.0 & Ratio.POIs.users <= 5.0, Levels.r.pois.u := "(3.0, 5.0]"]
real$Levels.r.pois.u <- as.factor(real$Levels.r.pois.u)
real$Levels.r.pois.u <- factor(real$Levels.r.pois.u, levels(real$Levels.r.pois.u)[c(4, 1, 2, 3)])
real$Levels.r.users.net <- rep("", nrow(real))
real[Ratio.total.users.net <= 0.2, Levels.r.users.net := "[0.0, 0.2]"]
real[Ratio.total.users.net > 0.2 & Ratio.total.users.net <= 0.4, Levels.r.users.net := "(0.2, 0.4]"]
real[Ratio.total.users.net > 0.4 & Ratio.total.users.net <= 0.6, Levels.r.users.net := "(0.4, 0.6]"]
real[Ratio.total.users.net > 0.6 & Ratio.total.users.net <= 0.8, Levels.r.users.net := "(0.6, 0.8]"]
real[Ratio.total.users.net > 0.8 & Ratio.total.users.net <= 1.0, Levels.r.users.net := "(0.8, 1.0]"]
real$Levels.r.users.net <- as.factor(real$Levels.r.users.net)
real$Levels.r.users.net <- factor(real$Levels.r.users.net, levels(real$Levels.r.users.net)[c(5, 1, 2, 3, 4)])
real$Levels.r.pois.net <- rep("", nrow(real))
real[Ratio.total.POIs.net <= 0.1,  Levels.r.pois.net := "[0, 0.1]"]
real[Ratio.total.POIs.net > 0.1 & Ratio.total.POIs.net <= 0.2,  Levels.r.pois.net := "(0.1, 0.2]"]
real[Ratio.total.POIs.net > 0.2 & Ratio.total.POIs.net <= 0.3,  Levels.r.pois.net := "(0.2, 0.3]"]
real[Ratio.total.POIs.net > 0.3 & Ratio.total.POIs.net <= 0.5,  Levels.r.pois.net := "(0.3, 0.5]"]
real$Levels.r.pois.net <- as.factor(real$Levels.r.pois.net)
real$Levels.r.pois.net <- factor(real$Levels.r.pois.net, levels(real$Levels.r.pois.net)[c(4, 1, 2, 3)])
real$Levels.warl.x <- rep("", nrow(real))
real[WARL.x <= 0.2, Levels.warl.x := "[0, 0.2]"]
real[WARL.x > 0.2 & WARL.x <= 0.4, Levels.warl.x := "(0.2, 0.4]"]
real[WARL.x > 0.4 & WARL.x <= 0.8, Levels.warl.x := "(0.4, 0.8]"]
real[WARL.x > 0.8 & WARL.x <= 2.4, Levels.warl.x := "(0.8, 2.4]"]
real$Levels.warl.x <- as.factor(real$Levels.warl.x)
real$Levels.warl.x <- factor(real$Levels.warl.x, levels(real$Levels.warl.x)[c(4, 1, 2, 3)])
table(real$Levels.r.users.net, real$POIs.dist)
real_ <- real[Type.Effect.Cost != "(-) reduction"]
table(real_$Levels.r.users.net, real_$POIs.dist)
table(synth$POIs.dist)
synth_ <- synth[Type.Effect.Cost != "(-) reduction"]
table(synth$POIs.dist)
table(synth_$POIs.dist)
table(real_$POIs.dist)
table(real_$Levels.r.users.net)
table(real_$Levels.r.pois.net)
table(real_$WARL.x)
table(real_$Levels.warl.x)
table(synth_$POIs.dist)
table(synth_$Alpha)
table(synth_$Levels.r.users.net)
table(synth_$Levels.r.pois.net)
table(synth_$Levels.warl.x)
