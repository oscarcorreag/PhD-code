library(data.table)
library(ggplot2)
setwd("C:/Users/oscarcg/Documents/phd/code/Pickup-Delivery/test/files/final/")
# setwd("./final")
my_theme_11 <- function(base_size = 11, base_family = "") {
# Starts with theme_grey and then modify some parts
theme_grey(base_size = base_size, base_family = base_family) %+replace%
theme(
# white panel with light grey border
panel.background = element_rect(fill = "white", colour = NA),
panel.border     = element_rect(fill = NA, colour = "grey70", size = 0.5),
# light grey, thinner gridlines
# => make them slightly darker to keep acceptable contrast
#panel.grid.major = element_line(colour = "grey87", size = 0.25),
#panel.grid.minor = element_line(colour = "grey87", size = 0.125),
# match axes ticks thickness to gridlines and colour to panel border
axis.ticks       = element_line(colour = "grey70", size = 0.25),
# match legend key to panel.background
#legend.key           = element_rect(fill = "white", colour = NA),
#legend.position      = "none",
#legend.background    = element_rect(fill = "white", size = 4, colour = "white"),
legend.background    = element_rect(color = "grey"),
legend.justification = c(1, 1),
legend.position      = c(1, 1),
#legend.title         = element_text(size = 9, lineheight = 0.9, colour = "black", hjust = 1, face="bold"),
legend.title         = element_blank(),
legend.text          = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
#legend.text           = element_text(size = 8, lineheight = 0.9, hjust = 1),
#legend.title          = element_text(size = 9),
# dark strips with light text (inverse contrast compared to theme_grey)
strip.background = element_rect(fill = "grey70", colour = NA),
strip.text       = element_text(colour = "white", size = rel(0.8)),
#axis.title.x = axis_x_title,
#axis.title.y = axis_y_title,
#axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 12, vjust = 0.5, face="bold"),
axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 9, vjust = 0.5),
#axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 12, angle = 90, vjust = 0.5, face="bold"),
axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 9, angle = 90, vjust = 0.5),
#axis.text    = element_text(size = 10, lineheight = 0.9, colour = "grey50", hjust = 1),
axis.text    = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
complete = TRUE
)
}
my_theme_10 <- function(base_size = 11, base_family = "") {
# Starts with theme_grey and then modify some parts
theme_grey(base_size = base_size, base_family = base_family) %+replace%
theme(
# white panel with light grey border
panel.background = element_rect(fill = "white", colour = NA),
panel.border     = element_rect(fill = NA, colour = "grey70", size = 0.5),
# light grey, thinner gridlines
# => make them slightly darker to keep acceptable contrast
#panel.grid.major = element_line(colour = "grey87", size = 0.25),
#panel.grid.minor = element_line(colour = "grey87", size = 0.125),
# match axes ticks thickness to gridlines and colour to panel border
axis.ticks       = element_line(colour = "grey70", size = 0.25),
# match legend key to panel.background
#legend.key           = element_rect(fill = "white", colour = NA),
#legend.position      = "none",
#legend.background    = element_rect(fill = "white", size = 4, colour = "white"),
legend.background    = element_rect(color = "grey"),
legend.justification = c(1, 0),
legend.position      = c(1, 0),
#legend.title         = element_text(size = 9, lineheight = 0.9, colour = "black", hjust = 1, face="bold"),
legend.title         = element_blank(),
legend.text          = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
#legend.text           = element_text(size = 8, lineheight = 0.9, hjust = 1),
#legend.title          = element_text(size = 9),
# dark strips with light text (inverse contrast compared to theme_grey)
strip.background = element_rect(fill = "grey70", colour = NA),
strip.text       = element_text(colour = "white", size = rel(0.8)),
#axis.title.x = axis_x_title,
#axis.title.y = axis_y_title,
#axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 12, vjust = 0.5, face="bold"),
axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 9, vjust = 0.5),
#axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 12, angle = 90, vjust = 0.5, face="bold"),
axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 9, angle = 90, vjust = 0.5),
#axis.text    = element_text(size = 10, lineheight = 0.9, colour = "grey50", hjust = 1),
axis.text    = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
complete = TRUE
)
}
my_theme_01 <- function(base_size = 11, base_family = "") {
# Starts with theme_grey and then modify some parts
theme_grey(base_size = base_size, base_family = base_family) %+replace%
theme(
# white panel with light grey border
panel.background = element_rect(fill = "white", colour = NA),
panel.border     = element_rect(fill = NA, colour = "grey70", size = 0.5),
# light grey, thinner gridlines
# => make them slightly darker to keep acceptable contrast
#panel.grid.major = element_line(colour = "grey87", size = 0.25),
#panel.grid.minor = element_line(colour = "grey87", size = 0.125),
# match axes ticks thickness to gridlines and colour to panel border
axis.ticks       = element_line(colour = "grey70", size = 0.25),
# match legend key to panel.background
#legend.key           = element_rect(fill = "white", colour = NA),
#legend.position      = "none",
#legend.background    = element_rect(fill = "white", size = 4, colour = "white"),
legend.background    = element_rect(color = "grey"),
legend.justification = c(0, 1),
legend.position      = c(0, 1),
#legend.title         = element_text(size = 9, lineheight = 0.9, colour = "black", hjust = 1, face="bold"),
legend.title         = element_blank(),
legend.text          = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
#legend.text           = element_text(size = 8, lineheight = 0.9, hjust = 1),
#legend.title          = element_text(size = 9),
# dark strips with light text (inverse contrast compared to theme_grey)
strip.background = element_rect(fill = "grey70", colour = NA),
strip.text       = element_text(colour = "white", size = rel(0.8)),
#axis.title.x = axis_x_title,
#axis.title.y = axis_y_title,
#axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 12, vjust = 0.5, face="bold"),
axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 9, vjust = 0.5),
#axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 12, angle = 90, vjust = 0.5, face="bold"),
axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 9, angle = 90, vjust = 0.5),
#axis.text    = element_text(size = 10, lineheight = 0.9, colour = "grey50", hjust = 1),
axis.text    = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
complete = TRUE
)
}
my_theme_00 <- function(base_size = 11, base_family = "") {
# Starts with theme_grey and then modify some parts
theme_grey(base_size = base_size, base_family = base_family) %+replace%
theme(
# white panel with light grey border
panel.background = element_rect(fill = "white", colour = NA),
panel.border     = element_rect(fill = NA, colour = "grey70", size = 0.5),
# light grey, thinner gridlines
# => make them slightly darker to keep acceptable contrast
#panel.grid.major = element_line(colour = "grey87", size = 0.25),
#panel.grid.minor = element_line(colour = "grey87", size = 0.125),
# match axes ticks thickness to gridlines and colour to panel border
axis.ticks       = element_line(colour = "grey70", size = 0.25),
# match legend key to panel.background
#legend.key           = element_rect(fill = "white", colour = NA),
#legend.position      = "none",
#legend.background    = element_rect(fill = "white", size = 4, colour = "white"),
legend.background    = element_rect(color = "grey"),
legend.justification = c(0, 0),
legend.position      = c(0, 0),
#legend.title         = element_text(size = 9, lineheight = 0.9, colour = "black", hjust = 1, face="bold"),
legend.title         = element_blank(),
legend.text          = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
#legend.text           = element_text(size = 8, lineheight = 0.9, hjust = 1),
#legend.title          = element_text(size = 9),
# dark strips with light text (inverse contrast compared to theme_grey)
strip.background = element_rect(fill = "grey70", colour = NA),
strip.text       = element_text(colour = "white", size = rel(0.8)),
#axis.title.x = axis_x_title,
#axis.title.y = axis_y_title,
#axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 12, vjust = 0.5, face="bold"),
axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 9, vjust = 0.5),
#axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 12, angle = 90, vjust = 0.5, face="bold"),
axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 9, angle = 90, vjust = 0.5),
#axis.text    = element_text(size = 10, lineheight = 0.9, colour = "grey50", hjust = 1),
axis.text    = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
complete = TRUE
)
}
my_theme_none <- function(base_size = 11, base_family = "") {
# Starts with theme_grey and then modify some parts
theme_grey(base_size = base_size, base_family = base_family) %+replace%
theme(
# white panel with light grey border
panel.background = element_rect(fill = "white", colour = NA),
panel.border     = element_rect(fill = NA, colour = "grey70", size = 0.5),
# light grey, thinner gridlines
# => make them slightly darker to keep acceptable contrast
#panel.grid.major = element_line(colour = "grey87", size = 0.25),
#panel.grid.minor = element_line(colour = "grey87", size = 0.125),
# match axes ticks thickness to gridlines and colour to panel border
axis.ticks       = element_line(colour = "grey70", size = 0.25),
# match legend key to panel.background
#legend.key           = element_rect(fill = "white", colour = NA),
legend.position      = "none",
#legend.background    = element_rect(fill = "white", size = 4, colour = "white"),
legend.background    = element_rect(color = "grey"),
legend.justification = c(1, 1),
#legend.position      = c(1, 1),
#legend.title         = element_text(size = 9, lineheight = 0.9, colour = "black", hjust = 1, face="bold"),
legend.title         = element_blank(),
legend.text          = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
#legend.text           = element_text(size = 8, lineheight = 0.9, hjust = 1),
#legend.title          = element_text(size = 9),
# dark strips with light text (inverse contrast compared to theme_grey)
strip.background = element_rect(fill = "grey70", colour = NA),
strip.text       = element_text(colour = "white", size = rel(0.8)),
#axis.title.x = axis_x_title,
#axis.title.y = axis_y_title,
#axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 12, vjust = 0.5, face="bold"),
axis.title.x = element_text(margin = margin(t = 5, r = 0, b = 0, l = 0), size = 9, vjust = 0.5),
#axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 12, angle = 90, vjust = 0.5, face="bold"),
axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0), size = 9, angle = 90, vjust = 0.5),
#axis.text    = element_text(size = 10, lineheight = 0.9, colour = "grey50", hjust = 1),
axis.text    = element_text(size = 8, lineheight = 0.9, colour = "black", hjust = 1),
complete = TRUE
)
}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
ird <- fread("Customers.csv")
ird[, Assignment := as.factor(Assignment)]
ird[, Partition := as.factor(Partition)]
ird[, Routing := as.factor(Routing)]
ird[, Zone := as.factor(Zone)]
ird[, Customers := as.factor(Customers)]
ird[, Ratio := as.factor(Ratio)]
ird[, Distribution := as.factor(Distribution)]
ird[, Limit := as.factor(Limit)]
ird[, Parameter := as.factor(Parameter)]
ird <- ird[Dedicated.cost == 0 & Cost != -1]
ird[Assignment == 'SP-Voronoi', Assignment := 'V']
ird[Assignment == 'LL-EP', Assignment := 'DIST(ra)']
ird[Routing == 'BB', Routing := 'BnB']
ird[, Approach := paste(Assignment, Routing, sep = "-")]
ird$Approach <- factor(ird$Approach, levels = c('V-NN', 'DIST(ra)-NN', 'V-BnB', 'DIST(ra)-BnB'))
ird[, Total.service.cost := Dedicated.cost + Service.cost]
View(ird)
p_ird_t <- ggplot(ird, aes(x = Customers, y = Elapsed.time, fill = Approach))
p_ird_t <- p_ird_t + geom_boxplot()
p_ird_t <- p_ird_t + scale_x_discrete()
#p_ird_t <- p_ird_t + scale_y_log10()
p_ird_t <- p_ird_t + my_theme_10()
p_ird_t <- p_ird_t + scale_fill_manual(values = c("#F0E442", "#D55E00", "#009E73", "#56B4E9"))
p_ird_t <- p_ird_t + labs(y = "Elapsed time (s)")
p_ird_t
p_ird_t <- ggplot(ird[Approach != 'V-BnB'], aes(x = Customers, y = Elapsed.time, fill = Approach))
p_ird_t <- p_ird_t + geom_boxplot()
p_ird_t <- p_ird_t + scale_x_discrete()
#p_ird_t <- p_ird_t + scale_y_log10()
p_ird_t <- p_ird_t + my_theme_11()
p_ird_t <- p_ird_t + scale_fill_manual(values = c("#F0E442", "#D55E00", "#009E73", "#56B4E9"))
p_ird_t <- p_ird_t + labs(y = "Elapsed time (s)")
p_ird_t
p_ird_t <- ggplot(ird, aes(x = Customers, y = Elapsed.time, fill = Approach))
p_ird_t <- p_ird_t + geom_boxplot()
p_ird_t <- p_ird_t + scale_x_discrete()
p_ird_t <- p_ird_t + scale_y_log10()
p_ird_t <- p_ird_t + my_theme_11()
p_ird_t <- p_ird_t + scale_fill_manual(values = c("#F0E442", "#D55E00", "#009E73", "#56B4E9"))
p_ird_t <- p_ird_t + labs(y = "Elapsed time (s)")
p_ird_t
p_ird_t <- ggplot(ird, aes(x = Customers, y = Elapsed.time, fill = Approach))
p_ird_t <- p_ird_t + geom_boxplot()
p_ird_t <- p_ird_t + scale_x_discrete()
p_ird_t <- p_ird_t + scale_y_log10()
p_ird_t <- p_ird_t + my_theme_10()
p_ird_t <- p_ird_t + scale_fill_manual(values = c("#F0E442", "#D55E00", "#009E73", "#56B4E9"))
p_ird_t <- p_ird_t + labs(y = "Elapsed time (s)")
p_ird_t
ird[Approach == "DIST(ra)-BnB"]
ird[Approach == "DIST(ra)-BnB" & Customers == 2048]
summary(ird[Approach == "DIST(ra)-BnB" & Customers == 2048, Elapsed.time])
summary(ird[Approach == "DIST(ra)-BnB" & Customers == 1024, Elapsed.time])
summary(ird[Approach == "DIST(ra)-BnB" & Customers == 256, Elapsed.time])
cdcrss <- fread("Model.csv")
View(cdcrss)
cdcrss <- fread("Model.csv")
View(cdcrss)
cdcrss[, Assignment := as.factor(Assignment)]
cdcrss[, Partition := as.factor(Partition)]
cdcrss[, Routing := as.factor(Routing)]
cdcrss[, Zone := as.factor(Zone)]
cdcrss[, Prop.served := Served / Customers]
cdcrss[, Customers := as.factor(Customers)]
cdcrss[, Ratio := as.factor(Ratio)]
cdcrss[, Distribution := as.factor(Distribution)]
cdcrss[, Limit := as.factor(Limit)]
cdcrss[, Parameter := as.factor(Parameter)]
cdcrss[, Classical := as.factor(Classical)]
cdcrss <- cdcrss[Cost != -1]
cdcrss[Assignment == 'SP-Voronoi', Assignment := 'V']
cdcrss[Assignment == 'LL-EP', Assignment := 'DIST(ra)']
cdcrss[Routing == 'BB', Routing := 'BnB']
cdcrss[, Approach := paste(Assignment, Routing, sep = "-")]
cdcrss$Approach <- factor(cdcrss$Approach, levels = c('V-NN', 'DIST(ra)-NN', 'V-BnB', 'DIST(ra)-BnB'))
cdcrss[, Total.service.cost := Dedicated.cost + Service.cost]
cdcrss_prop_f <- function(sd) {
baseline <- sd[Classical == 1, -1, with = FALSE]
other <- sd[Classical == 0, -1, with = FALSE]
if(nrow(baseline) == 1 & nrow(other) == 1){
other[1] / baseline[1]
}
}
sd_cols_cdcrss <- c("Classical", "Cost", "Service.cost", "Total.service.cost")
cdcrss_prop_dt <- cdcrss[, cdcrss_prop_f(.SD), by = list(Seed, Customers, Approach), .SDcols = sd_cols_cdcrss]
p_cdcrss_prop_c <- ggplot(ird_prop_dt, aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt, aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c
View(cdcrss_prop_dt)
cdcrss_prop_dt <- cdcrss[, cdcrss_prop_f(.SD), by = list(Seed, Customers, Approach, Stores), .SDcols = sd_cols_cdcrss]
View(cdcrss_prop_dt)
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(rows = vars(Stores))
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt, aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(rows = vars(Stores))
View(cdcrss_prop_dt)
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(rows = Stores)
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~Stores)
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Customers >= 64], aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~Stores)
p_cdcrss_prop_c
cdcrss_prop_dt[Customers >= 64]
cdcrss_prop_dt[, Customers >= 64]
View(cdcrss_prop_dt)
cdcrss_prop_dt[Customers >= 64]
cdcrss_prop_dt[Customers %in% c(64, 128, 256)]
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Customers %in% c(64, 128, 256)], aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~Stores)
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Customers %in% c(64, 128, 256)], aes(x = Stores, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~Customers)
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Customers %in% c(64, 128, 256)], aes(x = Stores, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~Customers)
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Customers %in% c(64, 128, 256)], aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~ Stores)
p_cdcrss_prop_c
hist(cdrss_prop_dt$Stores)
hist(cdcrss_prop_dt$Stores)
hist(cdcrss_prop_dt$Stores, breaks = 22)
cdcrss_prop_dt[Stores <= 4, Stores.cat := "<= 4"]
View(cdcrss_prop_dt)
cdcrss_prop_dt[Stores > 4, Stores.cat := "> 4"]
View(cdcrss_prop_dt)
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt, aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
#p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion MILP Service Cost")
p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~ Stores.cat)
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt, aes(x = Stores, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt, aes(x = as.factor(Stores), y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
# p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_y_continuous(breaks = c(1.0, 1.25, 1.5, 1.75, 2.0))
# p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
p_cdcrss_prop_c
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Approach == "DIST(ra)-BnB"], aes(x = as.factor(Stores), y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot()
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion Service Cost")
#p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~ Stores.cat)
p_cdcrss_prop_c
p_cdcrss_prop_c_2 <- ggplot(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 7], aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + geom_boxplot()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + scale_x_discrete()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + my_theme_11()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + labs(y = "Proportion Service Cost")
#p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + facet_grid(~ Stores.cat)
p_cdcrss_prop_c_2
p_cdcrss_prop_c
summary(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 7, Total.service.cost])
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Approach == "DIST(ra)-BnB"], aes(x = as.factor(Stores), y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot(varwidth = TRUE)
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion Service Cost")
#p_cdcrss_prop_c <- p_cdcrss_prop_c + facet_grid(~ Stores.cat)
p_cdcrss_prop_c
p_cdcrss_prop_c_2 <- ggplot(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 8], aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + geom_boxplot(varwidth = TRUE)
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + scale_x_discrete()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + my_theme_11()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + labs(y = "Proportion Service Cost")
#p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + facet_grid(~ Stores.cat)
p_cdcrss_prop_c_2
summary(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 8, Total.service.cost])
hist(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 8, Total.service.cost])
cdcrss <- fread("Model.csv")
cdcrss[, Assignment := as.factor(Assignment)]
cdcrss[, Partition := as.factor(Partition)]
cdcrss[, Routing := as.factor(Routing)]
cdcrss[, Zone := as.factor(Zone)]
cdcrss[, Prop.served := Served / Customers]
cdcrss[, Customers := as.factor(Customers)]
cdcrss[, Ratio := as.factor(Ratio)]
cdcrss[, Distribution := as.factor(Distribution)]
cdcrss[, Limit := as.factor(Limit)]
cdcrss[, Parameter := as.factor(Parameter)]
cdcrss[, Classical := as.factor(Classical)]
cdcrss <- cdcrss[Cost != -1]
cdcrss[Assignment == 'SP-Voronoi', Assignment := 'V']
cdcrss[Assignment == 'LL-EP', Assignment := 'DIST(ra)']
cdcrss[Routing == 'BB', Routing := 'BnB']
cdcrss[, Approach := paste(Assignment, Routing, sep = "-")]
cdcrss$Approach <- factor(cdcrss$Approach, levels = c('V-NN', 'DIST(ra)-NN', 'V-BnB', 'DIST(ra)-BnB'))
cdcrss[, Total.service.cost := Dedicated.cost + Service.cost]
cdcrss_prop_f <- function(sd) {
baseline <- sd[Classical == 1, -1, with = FALSE]
other <- sd[Classical == 0, -1, with = FALSE]
if(nrow(baseline) == 1 & nrow(other) == 1){
other[1] / baseline[1]
}
}
sd_cols_cdcrss <- c("Classical", "Cost", "Service.cost", "Total.service.cost")
sd_cols_cdcrss <- c("Classical", "Cost", "Service.cost", "Total.service.cost")
cdcrss_prop_dt <- cdcrss[, cdcrss_prop_f(.SD), by = list(Seed, Customers, Approach, Stores), .SDcols = sd_cols_cdcrss]
p_cdcrss_prop_c <- ggplot(cdcrss_prop_dt[Approach == "DIST(ra)-BnB"], aes(x = as.factor(Stores), y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_boxplot(varwidth = TRUE)
p_cdcrss_prop_c <- p_cdcrss_prop_c + scale_x_discrete()
p_cdcrss_prop_c <- p_cdcrss_prop_c + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c <- p_cdcrss_prop_c + my_theme_11()
p_cdcrss_prop_c <- p_cdcrss_prop_c + labs(y = "Proportion Service Cost")
p_cdcrss_prop_c
p_cdcrss_prop_c_2 <- ggplot(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 8], aes(x = Customers, y = Total.service.cost, fill = Approach))
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + geom_boxplot(varwidth = TRUE)
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + scale_x_discrete()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + geom_hline(yintercept=1.0, linetype="twodash", color = "red", size = 1)
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + my_theme_11()
p_cdcrss_prop_c_2 <- p_cdcrss_prop_c_2 + labs(y = "Proportion Service Cost")
p_cdcrss_prop_c_2
summary(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 8, Total.service.cost])
hist(cdcrss_prop_dt[Approach == "DIST(ra)-BnB" & Stores >= 8, Total.service.cost])
